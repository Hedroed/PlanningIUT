<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <meta charset="iso-8859-1">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <link rel='stylesheet' href='/stylesheets/style.css'/>
    <link rel="stylesheet" href="/css/font-awesome.min.css">
	<link href="https://fonts.googleapis.com/css?family=Chela+One" rel="stylesheet">
  </head>
  <body>
    <input type="checkbox" id="side-checkbox"></input>

    <div class="page">
        <label class="icon" id="side-icon" for="side-checkbox">
            <i class="fa fa-bars"></i>
        </label>
        <span onclick='window.location.reload(false)' id="reload-icon" class="icon">
            <i class="fa fa-repeat"></i>
        </span>
        <span id="scroll-text">Scroll top </span>
        <span class="icon" id="up-icon"  title="Scroll top">
            <div id="bg-scroll" class=""></div>
            <i class="fa fa-angle-double-up"></i>
        </span>

        <h1 class="title"><%= title %></h1>
        <div class="courses">
            <section>
                <%  var lastDate = 0;
                    for(var i=0; i<courses.length; i++) {
                        var momentStart = moment(courses[i].start),
                            momentEnd = moment(courses[i].end);
                        if(courses[i].start.getDate() != lastDate) {
                             if(courses[i].start.getDay() === 1) {
                                 %> <div class="line bottom"><%= momentStart.format("dddd D MMMM YYYY"); %></div> <%
                             }
                             else {
                                 %> <div class="line"><%= momentStart.format("dddd D MMMM YYYY"); %></div> <%
                             }
                        }
                        lastDate = courses[i].start.getDate();
                %>
                <div class="course">
                    <h2><%= courses[i].name %></h1>

                    <div>
                        <div class="course-text date start"><%= momentStart.format("Do MMMM HH:mm"); %></div>
                        -
                        <div class=" course-text date end"><%= momentEnd.format("Do MMMM HH:mm"); %></div>
                    </div>
                    <div class="course-text"><%= courses[i].location %></div>
                    <div class="course-text"><%= courses[i].description %></div>
                </div>
                <% } %>
            </section>
        </div>

        <div class="sideBar">
            <h1>Sélection groupe</h1>
            <form class="groupSelector" action="/" method="get">
                <select class="select" id="selectDeps">
                    <%
                    for ( var i = 0; i < options.deps.length; i++ )
                    {
                        var res = ( options.deps[ i ] === selectedDep ) ? "selected" : "";
                        %><option value="<%=options.deps[ i ] %>" <%=res %>><%=options.deps[ i ] %></option><%
                    }
                    %>
                </select>
                <select name="group" class="select" id="selectGroup">
                    <%
                        for ( var j = 0; j < options.deps.length; j++ ) {
                            var dep = options.deps[ j ];
                            var dis = ( dep === selectedDep ) ? "" : "hide";
                            for ( var i = 0; i < options[dep].length; i++ )
                            {
                                var res = ( options[dep][ i ] === selectedGroup ) ? "selected" : "";
                                %><option dep="<%=dep %>" value="<%=options[dep][ i ] %>" <%=res %> class="<%=dis %>"><%=options[dep][ i ] %></option><%
                            }
                        }
                    %>
                </select>
                <input type="submit" value="Valider" class="select" id="sendGroup">
                <input type="submit" value="Sauvegarder" class="select" id="saveGroup">
                <div id="pop-up" class=""><p>Error</p></div>
            </form>
            <div class="unused">
                <%var s = unused.length === 1 ? "":"s" %>
                <h1>Salle<%=s%> info<%=s%> libre<%=s%> à <%= moment().add(15,'minute').format("HH:mm")%></h1>
                <ul>
                <%
                    if(unused.length === 0) {
                        %><li>Aucune :(</li><%
                    }
                    for(var i=0; i<unused.length; i++) {
                        %><li><%=unused[i]%></li><%
                    }
                %>
                </ul>
            </div>
            <footer>Copyright (c) 2016 RYDIN Nathan and LUX Mathieu All Rights Reserved.</footer>
        </div>
    </div>

    <script src="/js/jquery-3.1.1.min.js"></script>
    <script src="/js/save.js"></script>
  </body>
</html>
